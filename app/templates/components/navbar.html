<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand" href="{{ url_for('home.home') }}">üìã MyLists</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                {% if current_user.is_authenticated %}

                <li class="nav-item dropdown">
                    <a class="nav-link position-relative" href="#" id="followingDropdown" role="button"
                        data-bs-toggle="dropdown">
                        üîñ Siguiendo
                        {% if current_user.unread_following_notifications_count() > 0 %}
                        <span class="badge bg-danger">{{ current_user.unread_following_notifications_count() }}</span>
                        {% endif %}
                    </a>

                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="followingDropdown">
                        {% for notification in current_user.get_following_notifications()[:5] %}
                        <li class="dropdown-item {% if not notification.is_read %}fw-bold{% endif %}">
                            {{ notification.message }} <br>
                            <small class="text-muted">{{ notification.timestamp.strftime('%d/%m/%Y %H:%M') }}</small>
                        </li>
                        {% endfor %}
                        <li><a class="dropdown-item text-center" href="{{ url_for('following.view_following') }}">Ver
                                todas</a></li>
                    </ul>
                </li>



                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('lists.dashboard') }}">Mis Listas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('users.profile') }}">Perfil</a>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link position-relative" href="#" id="notificationsDropdown" role="button"
                        data-bs-toggle="dropdown">
                        üîî
                        {% if current_user.unread_notifications_count() > 0 %}
                        <span class="badge bg-danger position-absolute top-0 start-100 translate-middle">
                            {{ current_user.unread_notifications_count() }}
                        </span>
                        {% endif %}
                    </a>

                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationsDropdown">
                        {% for notification in current_user.get_notifications()[:5] %}
                        <li class="dropdown-item {% if not notification.is_read %}fw-bold{% endif %}">
                            {{ notification.message }} <br>
                            <small class="text-muted">{{ notification.timestamp.strftime('%d/%m/%Y %H:%M') }}</small>
                        </li>
                        {% endfor %}
                        <li><a class="dropdown-item text-center" href="{{ url_for('notifications.view_all') }}">Ver
                                todas</a></li>
                    </ul>
                </li>


                {% if current_user.is_admin() %}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-warning" href="#" id="adminDropdown" role="button"
                        data-bs-toggle="dropdown">
                        ‚öôÔ∏è Admin
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{{ url_for('admin.admin_dashboard') }}">üìä Dashboard</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('admin.manage_categories') }}">üìÇ Categor√≠as</a>
                        </li>
                        <li><a class="dropdown-item" href="{{ url_for('admin.manage_badges') }}">üèÖ Badges</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('admin.edit_config') }}">‚öôÔ∏è Configuraci√≥n</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('admin.manage_users') }}">üë§ Usuarios</a></li>
                    </ul>
                </li>
                {% endif %}

                <li class="nav-item">
                    <a class="nav-link text-danger" href="{{ url_for('auth.logout') }}">Salir</a>
                </li>

                <!-- üî• BOT√ìN PARA CAMBIAR TEMA -->
                <li class="nav-item">
                    <button class="btn btn-outline-light ms-3" onclick="toggleTheme()">
                        {% if current_user.theme == "light" %}
                        üåô Modo Oscuro
                        {% else %}
                        ‚òÄÔ∏è Modo Claro
                        {% endif %}
                    </button>
                </li>

                {% else %}
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('auth.login') }}">Iniciar sesi√≥n</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('auth.register') }}">Registrarse</a>
                </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>